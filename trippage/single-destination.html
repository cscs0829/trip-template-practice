<!DOCTYPE html>
<html lang="ko">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>코끼리 사파리 공원 - 트립페이지</title>
	<link rel="icon" type="image/png" href="img/icon/bavel.png">

	<!-- Meta Description -->
	<meta name="description" content="트립페이지 - 여행 상품 판매 및 여행 정보 제공">
	<meta name="keywords" content="여행, 여행상품, 여행사, 여행정보, 여행가이드">
	<meta name="robots" content="index, nofollow">
	<meta name="web_author" content="트립페이지">
	<meta name="language" content="Korean">  

	<!-- Import Icon -->
  	<link rel="stylesheet" type="text/css" href="css/ionicons.min.css">

	<!-- Import Style -->
	<link rel="stylesheet" type="text/css" href="css/main.css">
	    <link rel="stylesheet" type="text/css" href="css/swiper.css">
    

	

</head>
<body style="background: #e6eaed;">

<!-- Navbar -->
<nav class="navbar single-destination-navbar">
	<div class="container">
		<div class="navbar-bars">
			<a href="#" class="navbar-title sidebar-toggle" style="padding: 0;"><i class="ion-navicon-round"></i></a>
        	<a href="index.html" class="navbar-title">트립페이지</a>
		</div>
		<div class="navbar-item">
			<a href="index.html" class="navbar-title">트립페이지</a>
			<ul>
		        <li><a href="destination.html">여행지</a></li>
			    <li><a href="gallery.html">갤러리</a></li>
			    <li><a data-slide="slides" data-slide-target="#discover">상품소개</a></li>
			    <li><a href="news.html">뉴스</a></li>
				<li><button class="btn-login" id="openLogin">로그인</button></li>
  		  	</ul>
		</div>
	</div>
</nav>

<!-- Sidebar -->
<div class="sidebar">
<ul class="sidebar-list">
	<li><a href="" class="close"><span class="ion-android-close"></span></a></li>
	<li class="sidebar-list-hover"><a href="index.html">홈</a></li>
    <li class="sidebar-list-hover"><a href="destination.html">여행지</a></li>
    <li class="sidebar-list-hover"><a href="gallery.html">갤러리</a></li>
    <li class="sidebar-list-hover"><a href="index.html#discover">상품소개</a></li>
    <li class="sidebar-list-hover"><a href="news.html">뉴스</a></li>
    <li><a class="btn btn-orange btn-round" href="login.html">로그인</a></li>
</ul>                    
</div>

<!-- Sidebar Overlay -->
<section class="sidebar-overlay"></section>

<!-- Login Form -->

<div class="login-form">
	<div class="login-top">
		<span class="close">&times;</span>
	</div>
	<div class="login">
		<h3 class="text-center">
			트립페이지 로그인
		</h3>
		<div class="form-input">
			<label>이메일</label> <br>
			<input type="email" name="" class="form-control">
		</div>
		<div class="form-input">
			<label>비밀번호</label> <br>
			<input type="password" name="" class="form-control">
		</div>
		<div class="form-input">
			<button type="submit" class="btn btn-login">로그인</button>
		</div>
		<a href="" class="text-center">계정이 없으신가요? 회원가입하기</a>
	</div>
</div>

<div class="login-overlay"></div>

<!-- Section -->

<section class="section-ticket">
	<div class="header">
		<img id="destination-image" src="img/elephant.jpg" alt="">
		<div class="overlay">
			<div class="desc">
				<h3 id="destination-title">로딩 중...</h3>
				<div id="destination-rating">
					<!-- 별점이 동적으로 로드됩니다 -->
				</div>
			</div>
		</div>
	</div>
	<div class="body">
		<div class="panel">
			<div class="panel-header">
				<span class="ion-android-clipboard"></span>&nbsp; 티켓 상세정보
			</div>
			<div class="panel-body">
				<div class="detail">
					<div class="col-1" id="destination-details">
						<!-- 여행지 상세정보가 동적으로 로드됩니다 -->
					</div>
					<div class="col-2">
						<b>시작가</b>
						<h2 id="destination-price"><b style="color: #f25601">로딩 중... </b><small>/ 1인</small></h2> <br>
						<a href="" data-slide="slides" data-slide-target="#find" class="btn-ticket btn-orange">티켓 찾기</a>
					</div>
				</div>
			</div>
		</div>
		<div class="panel">
			<div class="panel-header">
				<span class="ion-ios-bookmarks"></span>&nbsp; 상품 설명
			</div>
			<div class="panel-body" id="destination-description">
				<p>로딩 중...</p>
			</div>
		</div>
		<div class="panel">
			<div class="panel-header">
				<span class="ion-ios-bookmarks"></span>&nbsp; 하이라이트
			</div>
			<div class="panel-body" id="destination-highlights">
				<ul>
					<li>로딩 중...</li>
				</ul>
			</div>
		</div>
		<div class="panel">
			<div class="panel-header">
				<span class="ion-ios-map"></span>&nbsp; 위치
			</div>
			<div class="panel-body">
				<div class="col-1" id="destination-map">
					<!-- 지도가 동적으로 로드됩니다 -->
				</div>
				<div class="col-2" id="destination-location-info">
					<h3>교통편 및 장소 정보</h3>
					<p>로딩 중...</p>
				</div>
			</div>
		</div>
		<div class="panel">
			<div class="panel-body">
				<form class="form-horizontal" id="bookingForm">
					<div class="input-form">
						<label>날짜 선택</label>
						<input type="date" name="travelDate" id="travelDate" class="form-control" required>
					</div>
					<div class="input-form">
						<label>인원 수</label>
						<select class="form-control" name="paxCount" id="paxCount" required>
							<option value="1">1명</option>
							<option value="2">2명</option>
							<option value="3">3명</option>
							<option value="4">4명</option>
						</select>
					</div>
					<div class="input-form">
						<label>총 결제 금액</label>
						<div class="total-price" style="font-size: 24px; font-weight: bold; color: #f25601; margin-top: 10px;">
							₩ 120,000
						</div>
					</div>
					<div class="input-form" id="find">
						<label></label>
						<button type="button" class="btn btn-ticket btn-orange" style="margin-top: 37px;text-align: right;" id="paymentButton">구매하기</button>
					</div>
				</form>
			</div>
		</div>
	</div>
</section>

<section class="section-footer">
	<div class="row">
		<div class="col-left">
			<p>Copyright &copy; 2025</p>
			<p>서울특별시 강남구 테헤란로 123 <br>
			전화 : 02-1234-5678 <br>
			이메일 : contact@trippage.co.kr </p>
			<a href="https://www.facebook.com/trippage" target="_blank"><span class="ion-social-facebook icon-social"></span></a>
			<a href="https://www.instagram.com/trippage" target="_blank"><span class="ion-social-instagram icon-social"></span></a>
			<a href="https://twitter.com/trippage" target="_blank"><span class="ion-social-twitter icon-social"></span></a>
		</div>
		<div class="col-right">
			<b>여행 경험</b>
			<ul>
				<li><a href="#">자연</a></li>
				<li><a href="#">문화</a></li>
				<li><a href="#">종교</a></li>
				<li><a href="#">요리</a></li>
				<li><a href="#">모험</a></li>
			</ul>
		</div>
		<div class="col-right">
			<b>여행 가이드</b>
			<ul>
				<li><a href="#">관광 가이드</a></li>
				<li><a href="#">여행사</a></li>
				<li><a href="#">숙박시설</a></li>
				<li><a href="#">저예산 여행</a></li>
			</ul>
		</div>
		<div class="col-right">
			<b>소식</b>
			<ul>
				<li><a href="#">뉴스</a></li>
				<li><a href="#">이벤트</a></li>
				<li><a href="#">팁 & 정보</a></li>
			</ul>
		</div>
	</div>
	<div class="footer-bottom">
		<p><a href="https://github.com/cscs0829/trippage-page" rel="noreferer" target="_blank">트립페이지</a> - <span class="ion-heart red"></span>으로 만든 사랑스러운 웹사이트</p>
		</div>
</section>

    <script type="text/javascript" src="js/jquery.js"></script>
    <script type="text/javascript" src="js/main.js"></script>
    <script type="text/javascript" src="js/jquery.swipebox.min.js"></script>
    
    <script>
        // 현재 여행지 정보를 저장할 변수
        let currentDestination = null;

        // URL에서 slug 추출
        function getSlugFromUrl() {
            const pathParts = window.location.pathname.split('/');
            return pathParts[pathParts.length - 1];
        }

        // 여행지 상세 정보 로드
        async function loadDestinationDetails() {
            try {
                const slug = getSlugFromUrl();
                const response = await fetch(`/api/destinations/${slug}`);
                
                if (!response.ok) {
                    throw new Error('여행지를 찾을 수 없습니다.');
                }
                
                const destination = await response.json();
                currentDestination = destination;
                
                // 페이지 제목 업데이트
                document.title = `${destination.title} - 트립페이지`;
                
                // 헤더 정보 업데이트
                document.getElementById('destination-image').src = destination.image_url;
                document.getElementById('destination-image').alt = destination.name;
                document.getElementById('destination-title').textContent = destination.title;
                
                // 별점 표시
                const rating = Math.floor(destination.rating);
                let starsHtml = '';
                for (let i = 1; i <= 5; i++) {
                    if (i <= rating) {
                        starsHtml += '<span class="ion-ios-star checked"></span>';
                    } else {
                        starsHtml += '<span class="ion-ios-star"></span>';
                    }
                }
                document.getElementById('destination-rating').innerHTML = starsHtml;
                
                // 상세 정보 업데이트
                const detailsHtml = `
                    <div class="col">
                        <span class="ion-clock"></span> ${destination.schedule || '08:00 - 16:00'}
                    </div>
                    <div class="col">
                        <span class="ion-person-stalker"></span> 최소 ${destination.min_participants}명 | 최대 ${destination.max_participants}명
                    </div>
                    ${destination.includes ? destination.includes.map(item => `
                    <div class="col">
                        <span class="ion-checkmark-round"></span> ${item}
                    </div>
                    `).join('') : ''}
                `;
                document.getElementById('destination-details').innerHTML = detailsHtml;
                
                // 가격 정보 업데이트
                const priceDisplay = destination.price_max 
                    ? `₩ ${destination.price_min.toLocaleString()} - ₩ ${destination.price_max.toLocaleString()}`
                    : `₩ ${destination.price_min.toLocaleString()}`;
                document.getElementById('destination-price').innerHTML = `<b style="color: #f25601">${priceDisplay} </b><small>/ 1인</small>`;
                
                // 설명 업데이트
                document.getElementById('destination-description').innerHTML = `<p>${destination.description || '상세 설명이 없습니다.'}</p>`;
                
                // 하이라이트 업데이트
                if (destination.highlights && destination.highlights.length > 0) {
                    const highlightsHtml = destination.highlights.map(highlight => `<li>${highlight}</li>`).join('');
                    document.getElementById('destination-highlights').innerHTML = `<ul>${highlightsHtml}</ul>`;
                } else {
                    document.getElementById('destination-highlights').innerHTML = '<ul><li>하이라이트 정보가 없습니다.</li></ul>';
                }
                
                // 위치 정보 업데이트
                if (destination.map_embed_url) {
                    document.getElementById('destination-map').innerHTML = `<iframe src="${destination.map_embed_url}" width="600" height="450" frameborder="0" style="border:0" allowfullscreen></iframe>`;
                } else {
                    document.getElementById('destination-map').innerHTML = '<p>지도 정보가 없습니다.</p>';
                }
                
                document.getElementById('destination-location-info').innerHTML = `
                    <h3>교통편 및 장소 정보</h3>
                    <p>${destination.location_info || '위치 정보가 없습니다.'}</p>
                `;
                
                // 총 금액 초기화
                updateTotalPrice();
                
            } catch (error) {
                console.error('여행지 정보 로드 실패:', error);
                document.getElementById('destination-title').textContent = '여행지 정보를 불러올 수 없습니다.';
                document.getElementById('destination-description').innerHTML = '<p>여행지 정보를 불러오는데 실패했습니다. 잠시 후 다시 시도해주세요.</p>';
            }
        }

        // 총 금액 업데이트 함수
        function updateTotalPrice() {
            if (!currentDestination) return;
            
            const paxCount = parseInt(document.getElementById('paxCount').value);
            const basePrice = currentDestination.price_min;
            const totalPrice = basePrice * paxCount;
            
            document.querySelector('.total-price').innerHTML = `₩ ${totalPrice.toLocaleString()}`;
        }

        // 구매하기 버튼 클릭 이벤트
        document.getElementById('paymentButton').addEventListener('click', function() {
            // 폼 데이터 수집
            const travelDate = document.getElementById('travelDate').value;
            const paxCount = document.getElementById('paxCount').value;
            
            // 필수 정보 검증
            if (!travelDate) {
                alert('여행 날짜를 선택해주세요.');
                return;
            }
            
            if (!paxCount) {
                alert('인원 수를 선택해주세요.');
                return;
            }
            
            // 주문서 페이지로 이동 (URL 파라미터로 정보 전달)
            const checkoutUrl = `checkout-demo.html?date=${encodeURIComponent(travelDate)}&pax=${encodeURIComponent(paxCount)}`;
            window.location.href = checkoutUrl;
        });
        
        // 인원 수 변경 시 총 금액 업데이트
        document.getElementById('paxCount').addEventListener('change', function() {
            updateTotalPrice();
        });
        
        // 티켓 찾기 버튼 클릭 시 아래 주문 폼으로 스크롤
        document.querySelector('.btn-ticket').addEventListener('click', function(e) {
            e.preventDefault();
            const targetElement = document.getElementById('find');
            if (targetElement) {
                targetElement.scrollIntoView({ 
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
        
        // 페이지 로드 시 초기화
        document.addEventListener('DOMContentLoaded', function() {
            // 여행지 정보 로드
            loadDestinationDetails();
            
            // 오늘 날짜를 최소 선택 가능 날짜로 설정
            const today = new Date();
            const tomorrow = new Date(today);
            tomorrow.setDate(tomorrow.getDate() + 1);
            
            const tomorrowString = tomorrow.toISOString().split('T')[0];
            document.getElementById('travelDate').min = tomorrowString;
        });
        
        // 스크롤 이벤트로 navbar 스타일 변경
        window.addEventListener('scroll', function() {
            const navbar = document.querySelector('.navbar');
            const scrollPosition = window.scrollY;
            
            if (scrollPosition > 50) {
                navbar.classList.add('scrolled');
            } else {
                navbar.classList.remove('scrolled');
            }
        });
        
        // 사이드바 디버깅
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM 로드 완료');
            
            // jQuery 확인
            if (typeof $ !== 'undefined') {
                console.log('jQuery 로드됨');
                
                // 사이드바 토글 버튼 확인
                const sidebarToggle = $('.sidebar-toggle');
                console.log('사이드바 토글 버튼:', sidebarToggle.length);
                
                // 수동으로 이벤트 추가 (백업)
                $('.sidebar-toggle').off('click').on('click', function(e) {
                    console.log('사이드바 토글 클릭됨');
                    e.preventDefault();
                    $('.sidebar').addClass('active');
                    $('.sidebar-overlay').css('visibility', 'visible');
                });
                
                $('.sidebar-overlay, .close').off('click').on('click', function(e) {
                    console.log('사이드바 닫기 클릭됨');
                    e.preventDefault();
                    $('.sidebar').removeClass('active');
                    $('.sidebar-overlay').css('visibility', 'hidden');
                });
            } else {
                console.error('jQuery가 로드되지 않았습니다');
            }
        });
    </script>

</body>
</html>